# å‘åŒ…è„šæœ¬ä½¿ç”¨æŒ‡å—

Kode é¡¹ç›®æä¾›äº†ä¸¤å¥—å‘åŒ…æµç¨‹ï¼Œç”¨äºä¸åŒçš„å‘å¸ƒåœºæ™¯ï¼š

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### å¼€å‘ç‰ˆæœ¬å‘å¸ƒ (æµ‹è¯•ç”¨)
```bash
npm run publish:dev
```

### æ­£å¼ç‰ˆæœ¬å‘å¸ƒ
```bash
npm run publish:release
```

## ğŸ“¦ å‘åŒ…ç­–ç•¥

### 1. å¼€å‘ç‰ˆæœ¬ (`dev` tag)
- **ç›®çš„**: å†…éƒ¨æµ‹è¯•å’Œé¢„å‘å¸ƒéªŒè¯
- **ç‰ˆæœ¬æ ¼å¼**: `1.1.16-dev.1`, `1.1.16-dev.2`
- **å®‰è£…æ–¹å¼**: `npm install -g @shareai-lab/kode@dev`
- **ç‰¹ç‚¹**:
  - è‡ªåŠ¨é€’å¢ dev ç‰ˆæœ¬å·
  - ä¸å½±å“æ­£å¼ç‰ˆæœ¬çš„ç”¨æˆ·
  - å¯ä»¥å¿«é€Ÿè¿­ä»£æµ‹è¯•

### 2. æ­£å¼ç‰ˆæœ¬ (`latest` tag)
- **ç›®çš„**: é¢å‘æœ€ç»ˆç”¨æˆ·çš„ç¨³å®šç‰ˆæœ¬
- **ç‰ˆæœ¬æ ¼å¼**: `1.1.16`, `1.1.17`, `1.2.0`
- **å®‰è£…æ–¹å¼**: `npm install -g @shareai-lab/kode` (é»˜è®¤)
- **ç‰¹ç‚¹**:
  - è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
  - ä¸¥æ ¼çš„å‘å¸ƒæµç¨‹
  - åŒ…å«å®Œæ•´çš„æµ‹è¯•å’Œæ£€æŸ¥

## ğŸ› ï¸ è„šæœ¬åŠŸèƒ½è¯¦è§£

### å¼€å‘ç‰ˆæœ¬å‘å¸ƒ (`scripts/publish-dev.js`)

**è‡ªåŠ¨åŒ–æµç¨‹**:
1. âœ… æ£€æŸ¥å½“å‰åˆ†æ”¯å’Œå·¥ä½œåŒºçŠ¶æ€
2. ğŸ”¢ è‡ªåŠ¨ç”Ÿæˆé€’å¢çš„ dev ç‰ˆæœ¬å·
3. ğŸ”¨ æ„å»ºé¡¹ç›®
4. ğŸ” è¿è¡Œé¢„å‘å¸ƒæ£€æŸ¥
5. ğŸ“¤ å‘å¸ƒåˆ° npm çš„ `dev` tag
6. ğŸ·ï¸ åˆ›å»º git tag
7. ğŸ”„ æ¢å¤ package.json (ä¸æäº¤ç‰ˆæœ¬å˜æ›´)

**ä½¿ç”¨åœºæ™¯**:
- åŠŸèƒ½å¼€å‘å®Œæˆï¼Œéœ€è¦å†…éƒ¨æµ‹è¯•
- PR åˆå¹¶å‰çš„æœ€ç»ˆéªŒè¯
- å¿«é€Ÿä¿®å¤éªŒè¯

**å®‰å…¨ç‰¹æ€§**:
- ä¸´æ—¶ä¿®æ”¹ package.jsonï¼Œå‘å¸ƒåè‡ªåŠ¨æ¢å¤
- å¤±è´¥æ—¶è‡ªåŠ¨å›æ»š
- ä¸æ±¡æŸ“ä¸»åˆ†æ”¯ç‰ˆæœ¬å·

### æ­£å¼ç‰ˆæœ¬å‘å¸ƒ (`scripts/publish-release.js`)

**äº¤äº’å¼æµç¨‹**:
1. ğŸ” æ£€æŸ¥åˆ†æ”¯ (å»ºè®®åœ¨ main/master)
2. ğŸ§¹ ç¡®ä¿å·¥ä½œåŒºå¹²å‡€
3. ğŸ“¡ æ‹‰å–æœ€æ–°ä»£ç 
4. ğŸ”¢ é€‰æ‹©ç‰ˆæœ¬å‡çº§ç±»å‹:
   - **patch** (1.1.16 â†’ 1.1.17): ä¿®å¤ bug
   - **minor** (1.1.16 â†’ 1.2.0): æ–°åŠŸèƒ½
   - **major** (1.1.16 â†’ 2.0.0): ç ´åæ€§å˜æ›´
   - **custom**: è‡ªå®šä¹‰ç‰ˆæœ¬å·
5. âœ… ç¡®è®¤å‘å¸ƒä¿¡æ¯
6. ğŸ§ª è¿è¡Œæµ‹è¯•å’Œç±»å‹æ£€æŸ¥
7. ğŸ”¨ æ„å»ºé¡¹ç›®
8. ğŸ“ æäº¤ç‰ˆæœ¬æ›´æ–°
9. ğŸ·ï¸ åˆ›å»º git tag
10. ğŸ“¤ å‘å¸ƒåˆ° npm (é»˜è®¤ `latest` tag)
11. ğŸ“¡ æ¨é€åˆ° git ä»“åº“

**å®‰å…¨ç‰¹æ€§**:
- äº¤äº’å¼ç¡®è®¤ï¼Œé¿å…è¯¯å‘å¸ƒ
- æµ‹è¯•å¤±è´¥æ—¶è‡ªåŠ¨å›æ»šç‰ˆæœ¬å·
- å®Œæ•´çš„ git å†å²è®°å½•

## ğŸ¯ æœ€ä½³å®è·µ

### å¼€å‘æµç¨‹å»ºè®®
```bash
# 1. å¼€å‘åŠŸèƒ½
git checkout -b feature/new-feature
# ... å¼€å‘ä»£ç  ...
git commit -am "feat: add new feature"

# 2. å‘å¸ƒå¼€å‘ç‰ˆæœ¬æµ‹è¯•
npm run publish:dev
# å®‰è£…æµ‹è¯•: npm install -g @shareai-lab/kode@dev

# 3. æµ‹è¯•é€šè¿‡ååˆå¹¶åˆ°ä¸»åˆ†æ”¯
git checkout main
git merge feature/new-feature

# 4. å‘å¸ƒæ­£å¼ç‰ˆæœ¬
npm run publish:release
```

### ç‰ˆæœ¬å·ç®¡ç†
- **å¼€å‘ç‰ˆ**: åŸºäºå½“å‰æ­£å¼ç‰ˆæœ¬è‡ªåŠ¨é€’å¢
- **æ­£å¼ç‰ˆ**: éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/) è§„èŒƒ
- **Git æ ‡ç­¾**: è‡ªåŠ¨åˆ›å»ºï¼Œæ ¼å¼ `v1.1.16`

### æ ‡ç­¾ç®¡ç†
```bash
# æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬
npm view @shareai-lab/kode versions --json

# æŸ¥çœ‹ dev ç‰ˆæœ¬
npm view @shareai-lab/kode@dev version

# æŸ¥çœ‹æœ€æ–°æ­£å¼ç‰ˆæœ¬  
npm view @shareai-lab/kode@latest version
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**å‘å¸ƒå¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
- è„šæœ¬ä¼šè‡ªåŠ¨å›æ»š package.json
- æ£€æŸ¥é”™è¯¯ä¿¡æ¯ï¼Œä¿®å¤åé‡æ–°è¿è¡Œ

**ç‰ˆæœ¬å·å†²çªï¼Ÿ**
- å¼€å‘ç‰ˆæœ¬ä¼šè‡ªåŠ¨é€’å¢ï¼Œä¸ä¼šå†²çª
- æ­£å¼ç‰ˆæœ¬å‘å¸ƒå‰ä¼šæ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨

**æƒé™é—®é¢˜ï¼Ÿ**
- ç¡®ä¿å·²ç™»å½• npm: `npm whoami`
- ç¡®ä¿æœ‰åŒ…çš„å‘å¸ƒæƒé™

**Git ç›¸å…³é”™è¯¯ï¼Ÿ**
- ç¡®ä¿æœ‰ git æ¨é€æƒé™
- æ£€æŸ¥è¿œç¨‹ä»“åº“é…ç½®: `git remote -v`

### æ‰‹åŠ¨æ¸…ç†
```bash
# å¦‚æœå‘å¸ƒè¿‡ç¨‹ä¸­æ–­ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨æ¸…ç†
git tag -d v1.1.16-dev.1  # åˆ é™¤æœ¬åœ°æ ‡ç­¾
git push origin :v1.1.16-dev.1  # åˆ é™¤è¿œç¨‹æ ‡ç­¾
```

## ğŸ“Š ç›‘æ§å’Œåˆ†æ

```bash
# æŸ¥çœ‹åŒ…ä¸‹è½½ç»Ÿè®¡
npm view @shareai-lab/kode

# æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬çš„è¯¦ç»†ä¿¡æ¯
npm view @shareai-lab/kode versions --json

# æµ‹è¯•å®‰è£…
npm install -g @shareai-lab/kode@dev
kode --version
```

---

é€šè¿‡è¿™å¥—åŒå‘åŒ…ç³»ç»Ÿï¼Œä½ å¯ä»¥ï¼š
- ğŸš€ å¿«é€Ÿå‘å¸ƒå¼€å‘ç‰ˆæœ¬è¿›è¡Œå†…éƒ¨æµ‹è¯•
- ğŸ›¡ï¸ å®‰å…¨å‘å¸ƒæ­£å¼ç‰ˆæœ¬ç»™æœ€ç»ˆç”¨æˆ·
- ğŸ“ˆ ä¿æŒæ¸…æ™°çš„ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒå†å²
- âš¡ è‡ªåŠ¨åŒ–å¤§éƒ¨åˆ†é‡å¤æ“ä½œï¼Œå‡å°‘äººä¸ºé”™è¯¯